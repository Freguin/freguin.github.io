<html><head>
		<meta charset="UTF-8">
		<style>
		@font-face {
		    font-family: 'Pixelated';
		    src: url("FFFFORWA.TTF") format('truetype');
			}
		</style>
	</head>
	<body style="background-size:cover;left: 0;position: relative;margin: 0;overflow: hidden;">
		<canvas id="canvas" width="500" height="500"></canvas>
		<script>
			width = document.body.clientWidth;
			height = document.body.clientHeight;
			window.onload=function(){
				document.getElementById('canvas').width = width;
				document.getElementById('canvas').height = height;
				c = document.getElementById('canvas').getContext('2d')
				setInterval(update,1000/30);
				//c.addEventListener("mousemove",function(e){
				//	p1y = e.clientY-paddleHeight/2;
				//});
				document.addEventListener('mousemove',function(e){
					p1y = e.clientY-paddleHeight*0.5;
				});
			}
			paddle2Speed = 4;
			ballRad = 4;
			ballX = width*0.5;
			ballY = height*0.5;
			ballXV = ballYV = 8;
			paddleHeight = height/7;
			paddleWidth = 15;
			p1y = 0.5*height-paddleHeight*0.5;
			p2y = 0.5*height-paddleHeight*0.5;
			score1 = score2 = 0;
			p1x = 15;
			p2x = width-paddleWidth-15;
			moving = false;
			moveTo;
			
			function reset(){
				ballX = width*0.5;
				ballY = height*0.5;
				if(ballXV>0){
					ballXV = ballYV = -8;
				} else {
					ballXV = ballYV = 8;
					paddleAI();
				}
			}
			reset();
			function move(to){
				aispeed = 5;
				if((p2y+0.5*paddleHeight)-to>aispeed){
					p2y-=aispeed;
				}
				else if(to-(p2y+0.5*paddleHeight)>aispeed){
					p2y+=aispeed;
				}
			}
			
			function paddleAI(){
				x1=(ballX*(ballYV/ballXV)-ballY+ballRad)/(ballYV/ballXV);
				x2=(ballX*(ballYV/ballXV)-ballY+(height-ballRad))/(ballYV/ballXV);
				y1 = ballYV*(p2x-ballRad)/ballXV-ballYV*ballX/ballXV+ballY; //correct
				function hitsX(xv,yv,x,y){
					hx1=(x*(yv/xv)-y+ballRad)/(yv/xv);
					hx2=(x*(yv/xv)-y+(height-ballRad))/(yv/xv);
					hy1 = yv*(p2x-ballRad)/xv-yv*x/xv+y;				
					if(hx1<=width-paddleWidth-15-ballRad && hx1 > x){
						hitsX(xv,yv*-1,hx1,ballRad);
					}
					else if(hx2<=width-paddleWidth-15-ballRad && hx2 > x){
						hitsX(xv,yv*-1,hx2,height-ballRad);
					}
					else {
						moveTo = hy1;
						moving = true;
					}
				}
			if(x1<=width-paddleWidth-15-ballRad && x1 > ballX){
				hitsX(ballXV,ballYV*-1,x1,ballRad);
			}
			else if(x2<=width-paddleWidth-15-ballRad && x2 > ballX){
				hitsX(ballXV,ballYV*-1,x2,height-ballRad);
			}
			else {
				moveTo = y1;
				moving = true;
			}
			}
			function update(){
				ballX+=ballXV;
				ballY+=ballYV;
				if(width-ballX<=ballRad){
					score1++;
					reset();
				}
				if(ballX<=ballRad){
					score2++
					reset();
				}
				xTop=(ballX*(ballYV/ballXV)-ballY+(p1y-ballRad))/(ballYV/ballXV);
				xBottom=(ballX*(ballYV/ballXV)-ballY+(p1y+paddleHeight+ballRad))/(ballYV/ballXV);
				if(((xTop>=p1x && xTop <= p1x+paddleWidth) || (xBottom>=p1x && xBottom <=p1x+paddleWidth)) && ballX >=p1x && ballX <=p1x+paddleWidth) {
				   ballYV*=-1;
				   ballY+=ballYV;
				   ballX+=ballXV;
				   }
				y = ballYV*(p1x+paddleWidth+ballRad)/ballXV-ballYV*ballX/ballXV+ballY;
				if(y>=p1y && y<=p1y+paddleHeight) {
				   ballXV*=-1.3;
				   ballYV=(ballY-(p1y+0.5*paddleHeight))*0.5;
				   paddleAI();
				   }
				
				xTop=(ballX*(ballYV/ballXV)-ballY+(p1y-ballRad))/(ballYV/ballXV);
				xBottom=(ballX*(ballYV/ballXV)-ballY+(p1y+paddleHeight+ballRad))/(ballYV/ballXV);
				if((xTop>=p2x && xTop <= p2x+paddleWidth) || (xBottom>=p2x && xBottom <=p2x+paddleWidth)) {
				   ballYV*=-1;
				   ballY+=ballYV;
				   ballX+=ballXV;
				   moving = false;
				   }
				y = ballYV*(p2x-ballRad)/ballXV-ballYV*ballX/ballXV+ballY;
				if(y>=p2y && y<=p2y+paddleHeight) {
				   ballXV*=-1.15;
				   ballYV=(ballY-(p2y+0.5*paddleHeight))*0.5;
				   moving = false;
				   }
	
				if(height-ballY<=ballRad || ballY<=ballRad){
					ballYV*=-1;
				}
				if(moving){
					move(moveTo);
				}
				c.fillStyle='black';
				c.fillRect(0,0,width,height);
				c.fillStyle='white';
				c.fillRect(15,p1y,paddleWidth,paddleHeight);
				c.fillRect(width-paddleWidth-15,p2y,paddleWidth,paddleHeight);
				c.beginPath();
				c.arc(ballX,ballY, ballRad, 0, 2 * Math.PI, false);
				c.fill()
				c.strokeStyle = '#ffffff';
				c.stroke();
				for(i=0;i<=height;i+=60){
				c.fillRect(width/2,i,10,30);
				}
				c.font = "42px Pixelated"
				c.fillText(score1,width/4,70);
				c.fillText(score2,width*3/4,70);
			}
		</script>
	

</body></html>
